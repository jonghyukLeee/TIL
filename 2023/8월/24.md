# DB Lock

### 낙관적 Lock
- 충돌이 발생하지 않는다고 가정하는 방식.(이 부분을 낙관적이라 표현)
- DB의 Lock을 사용하는 것이 아닌, 애플리케이션 레벨에서 version을 통해 동시성을 제어한다.
- 조회 시 version 컬럼을 같이 읽어옴으로써 해당 값을 기준으로 비교하여 version이 다르다면 예외를 발생시킨다.

### 비관적 Lock
- 충돌 상황을 고려하여 DB row에 Lock을 적용한다.
- 한 트랜잭션이 해당 row를 수정하고 있다면 다른 트랜잭션은 접근할 수 없기 때문에 동시 변경에 대해 안정성을 보장받을 수 있다.

### 정리
- DB와 상관 없이 어플리케이션 로직 내에서 해결할 수 있기 때문에 낙관적 Lock이 더 성능이 좋다.
- 하지만, 트랜잭션이 존재하지 않기 때문에, 충돌이 발생했을 때 롤백을 수동으로 처리해줘야 한다.
- 성능과 데이터 일관성 등 각각의 중요도에 따라 적절히 판단하여 사용한다.

## 트랜잭션 격리 수준과 DB Lock 차이점
- 트랜잭션 격리 수준은 데이터 읽기에 대한 일관성을 보장해주는 것
    - 따라서 아래와 같은 격리 수준을 제공한다.
        - 아직 커밋되지 않았다면 읽을 수 없음
        - 읽기만 가능
        - 등등
- DB Lock은 수정중인 특정 엔티티에 대한 접근(Access)을 제한하는 것