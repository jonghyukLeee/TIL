# 오늘 목표

---

- [x]  로그인 리다이렉트 수정
- [x]  accessToken 전달방식 수정
- [x]  업체 조회 API
- [x]  프로필 사진 변경 API

# 오늘 배운점

---

# 쿠키 옵션

토큰을 쿠키에 담을 때, HttpOnly, Secure 속성을 true로 사용하고 있었는데, 이 둘의 용도를 정확히 알지 못하고 사용하고 있었다.

- HttpOnly : 이 속성을 사용하지 않으면 브라우저에서 쿠키값을 자바스크립트 코드로 조회할 수 있기 때문에, 이를 방지하고자 HttpOnly 속성을 사용한다.
- Secure : 이 속성은 쿠키가 Https 통신에서만 전송 가능하도록 해준다.

다중 서버를 구성하고 있기 때문에 JWT 토큰을 사용하며, access/refresh 토큰을 다룬다.
프론트와 소통하는 과정에서, 편의를 위해 두 토큰을 모두 쿠키에 담아 전송하기로 결정하고 적용했었는데, 테스트해보니 프론트에서 토큰값을 제대로 읽지 못하고 있었다.
토큰을 담은 두 쿠키 모두 HttpOnly 옵션이 true 였고, 당연히 프론트에서는 해당 값들을 읽어올 수 없었던 이유이다.
따라서 accessToken은 응답 바디를통해 전송하고, refreshToken만 기존처럼 쿠키로 전송하도록 변경하였다.

# Page, Slice 차이

- Page : 페이지 조회 이후 카운트 쿼리를 추가적으로 날려, 총합 카운트값을 얻어온다.
- Slice : 총 카운트 없이 페이지값만 받아오고, hasNext(boolean) 값을 통해 다음 값이 존재하는지 여부를 알 수있다.

무한스크롤 기능을 사용하기 위해 위 둘의 차이를 공부하고, 적합한 방식으로 Slice를 채택하려 했으나, 정렬 조건 자체가 실시간으로 자주 바뀌는 조건이다보니 무한스크롤을 적용하기 적절치 않았다.
따라서 방식만 익혀두고, 기록만 해두기로 했다.
다음에 무한스크롤 또는 비슷한 페이징을 구현하게 된다면 잘 활용할 수 있을 것 같다.