# 오늘 배운점

---

### Dockerfile

- 완성된 이미지를 생성하기 위해 컨테이너에 설치해야 하는 패키지, 추가해야 하는 소스코드, 실행해야 하는 명령어와 셸 스크립트 등을 도커파일에 작성하고, 도커는 이 파일을 읽어 컨테이너에서 작업을 수행한 뒤 이미지로 만들어낸다.
- build 명령어로 생성
- 직접 컨테이너를 생성하고 이미지로 커밋해야 하는 번거로움을 덜 수 있고, 다른 개발 도구를 통해 빌드 및 배포를 자동화할 수 있다.
- 도커 엔진은 기본적으로 현재 디렉터리에 있는 Dockerfile이라는 이름의 파일을 선택함

### 명령어 정리

- FROM
    - 생성할 이미지의 베이스가 될 이미지
    - 반드시 한 번 이상 입력해야함
    - 이미지가 없으면 자동으로 pull
- LABEL
    - 이미지에 메타데이터를 추가함
    - Key,Value 형태
    - 여러개 가능
    - docker inspect 명령어로 이미지의 정보를 확인할 수 있음
- RUN
    - 이미지를 만들기 위해 컨테이너 내부에서 명령어를 실행함
    - 이미지를 빌드하는 과정에서는 별도의 입력을 받을 수 없기 때문에, 설치 여부를 선택하는 Y/N같은 과정이 있을 경우 오류로 간주하고 빌드가 종료됨.
- ADD
    - 파일을 이미지에 추가
    - Dockerfile이 위치한 디렉터리의 컨텍스트에서 가져옴
    - JSON 배열 형태로 사용할 수 있고, 마지막 원소가 컨테이너에 추가될 위치
- WORKDIR
    - 명령어를 실행할 디렉터리
    - 배시 셸에서 cd 명령어를 입력하는 것과 동일한 기능
- EXPOSE
    - Dockerfile의 빌드로 생성된 이미지에서 노출할 포트를 설정
    - 하지만 반드시 이 포트가 호스트의 포트와 바인딩 되는 것은 아니며, 단지 해당 포트를 사용할 것임을 나타내는 것 뿐임
    - 이미지가 실제로 사용될 때 어떤 포트가 사용돼야 하는 지를 명시
- CMD
    - 컨테이너가 시작될 때마다 실행할 명령어를 설정
    - 한 번만 사용할 수 있음
    - 이미지에 기본적으로 내장된 커맨드나, run 명령어 실행 시 정의된 커맨드가 있을 경우 충돌이 생긴다. 따라서 여러 개의 명령어가 필요할 경우 JSON 배열 형태로 사용한다.
    

### Dockerfile 빌드

- 이미지 생성
    - docker build -t {이미지 이름}
        - -t 옵션으로 이름을 설정할 수 있음.
    - build 명령어의 끝에는 Dockerfile이 저장된 경로를 입력한다.
- 생성된 이미지로 컨테이너 실행
    - -P 옵션을 통해 EXPOSE에 기입한 포트를 호스트에 연결하도록 설정.
- 이미지 빌드 순서
    - 이미지 빌드를 시작하면 도커는 가장 먼저 빌드 컨텍스트를 읽어들임
        - 빌드 컨텍스트
            - 이미지를 생성하는데 필요한 각종 파일, 소스코드, 메타데이터 등을 담고 있는 디렉터리. (Dockerfile이 위치한 디렉터리)
            - 빌드될 이미지에 파일을 추가할 때 사용됨
            - build 명령어의 맨 마지막에 기입한 경로에 있는 파일을 전부 포함함. (하위 디렉터리도)
            - 외부 url도 마찬가지로 모두 포함
            - 따라서 Dockerfile이 위치한 디렉토리에는 이미지 빌드에 필요한 파일만 있는것이 바람직함 (특히 루트 디렉토리 ㄴㄴ)

# 오늘 느낀점

---

- 다음주부터 휴가철이라 부모님과 여행을 가기로 했는데, 그 전에 공부 많이 해놔야 맘편히 놀 수 있을 것 같다!
신난다..!

# 내일 목표

---

- dockerfile , docker-compose
- github actions